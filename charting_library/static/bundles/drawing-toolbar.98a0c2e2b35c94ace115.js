webpackJsonp([17],{1047:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" width="10" height="16"><path d="M.6 1.4l1.4-1.4 8 8-8 8-1.4-1.4 6.389-6.532-6.389-6.668z"/></svg>'},1048:function(e,t,o){"use strict";var n,i,r,a,l;o.d(t,"a",function(){return l}),n=o(10),i=o.n(n),r=o(44),o.n(r),function(e){function t(t){return e.favorites.indexOf(t)}function o(){e.favorites=[],Object(r.getJSON)("chart.favoriteDrawings",[]).forEach(function(t){e.favorites.push(t.tool||t)}),e.favoritesSynced.fire()}function n(){Object(r.setJSON)("chart.favoriteDrawings",e.favorites)}e.favorites=[],e.favoritesSynced=new i.a,e.favoriteIndex=t,e.saveFavorites=n,o(),r.onSync.subscribe(null,o)}(a||(a={})),function(e){function t(){return a.favorites.slice()}function o(){return a.favorites.length}function n(e){return e<0||e>=o()?"":a.favorites[e]}function r(t){return!s(t)&&(a.favorites.push(t),a.saveFavorites(),e.favoriteAdded.fire(t),!0)}function l(t){var o=a.favoriteIndex(t);return-1!==o&&(a.favorites.splice(o,1),a.saveFavorites(),e.favoriteRemoved.fire(t),!0)}function s(e){return-1!==a.favoriteIndex(e)}function c(t,n){if(n<0||n>=o())return!1;var i=a.favoriteIndex(t);return-1!==i&&n!==i&&(a.favorites.splice(i,1),a.favorites.splice(n,0,t),a.saveFavorites(),e.favoriteMoved.fire(t,i,n),!0)}e.favoriteAdded=new i.a,e.favoriteRemoved=new i.a,e.favoriteMoved=new i.a,e.favoritesSynced=a.favoritesSynced,e.favorites=t,e.favoritesCount=o,e.favorite=n,e.addFavorite=r,e.removeFavorite=l,e.isFavorite=s,e.moveFavorite=c}(l||(l={}))},1091:function(e,t){e.exports={wrap:"wrap-1h7U5nKd-",scrollWrap:"scrollWrap-3gtPS0Fe-",noScrollBar:"noScrollBar-ieMwbfur-",content:"content-YhoA_L2m-",icon:"icon-2xObs8DI-",scrollBot:"scrollBot-2HHpZNuf-",scrollTop:"scrollTop-1eXi8ltS-",isVisible:"isVisible-3zZOL3TO-",iconWrap:"iconWrap-2Q69rfEO-",fadeBot:"fadeBot-3JstnoWq-",fadeTop:"fadeTop-3oJzNyTq-"}},1092:function(e,t){e.exports={button:"button-263WXsg--",bg:"bg-1kRv1Pf2-",isBgFull:"isBgFull-CmoDGRQP-",icon:"icon-1Y-3MM9F-",hovered:"hovered--MYZioUu-",isActive:"isActive-2mI1-NUL-",isGrayed:"isGrayed-1kWObWVr-",isTransparent:"isTransparent-sRmateFl-",isHidden:"isHidden-2VzaskeU-"}},1093:function(e,t){e.exports={dropdown:"dropdown-3_ASLzSj-",buttonWrap:"buttonWrap-3fZWypJl-",control:"control-1TyEfSIx-",arrow:"arrow-1cFKS5Ok-",arrowIcon:"arrowIcon-2wA7q8om-",isOpened:"isOpened-22vLOY9o-",isGrayed:"isGrayed-xr-mULNo-"}},1094:function(e,t){e.exports={wrap:"wrap-2I6DAtXG-",buttonIcon:"buttonIcon-2rBwJ1QM-",item:"item-31XunD5q-",hovered:"hovered-2A1Cpat5-",button:"button-21ihqWJ8-"}},1095:function(e,t){e.exports={item:"item-62xp8vsV-",enter:"enter-21AyqfcZ-",enterActive:"enterActive-kua-y7K8-",leave:"leave-4EzZ54xf-"}},1096:function(e,t){e.exports={container:"container-3_8ayT2Q-",mirror:"mirror-crJbq8d0-",background:"background-Q1Fcmxly-",arrow:"arrow-WcYWFXUn-"}},1097:function(e,t){e.exports={drawingToolbar:"drawingToolbar-U3_QXRof-",isHidden:"isHidden-2d-PYkzV-",inner:"inner-1xuW-gY4-",toggleButton:"toggleButton-13QgefpG-",
collapsed:"collapsed-2trH0gCi-",group:"group-2JyOhh7Z-",separator:"separator-1BAqp1-l-"}},1198:function(e,t,o){"use strict";function n(e){var t,o=e.activeClass,n=e.children,i=e.className,r=e.icon,a=e.isActive,l=e.isBgFull,c=e.isGrayed,d=e.isHidden,p=e.isTransparent,h=e.onClick,m=e.title,f=e.buttonHotKey;return s.createElement("div",{className:u(N.button,i,a?o:"",(t={},t["apply-common-tooltip common-tooltip-vertical"]=!!m,t[N.isActive]=a,t[N.isBgFull]=l,t[N.isGrayed]=c,t[N.isHidden]=d,t[N.isTransparent]=p,t)),onClick:h,title:m,"data-tooltip-hotkey":f},s.createElement("div",{className:N.bg},r&&("string"==typeof r?s.createElement(_.a,{className:N.icon,icon:r}):s.createElement("span",{className:N.icon},r)),n))}function i(e){var t=e.action,o=e.isActive,i=e.isBgFull,r=e.isHidden,a=e.isTransparent,l=e.toolName;return s.createElement(n,{icon:v.lineToolsInfo[l].icon,isActive:o,isBgFull:i,isHidden:r,isTransparent:a,onClick:t,title:v.lineToolsInfo[l].localizedName})}function r(e){return s.createElement("svg",{xmlns:ie,width:"9",height:"27",viewBox:"0 0 9 27",className:u(ne.container,"right"===e.direction?ne.mirror:null)},s.createElement("g",{fill:"none",fillRule:"evenodd"},s.createElement("path",{className:ne.background,d:"M4.5.5a4 4 0 0 1 4 4v18a4 4 0 1 1-8 0v-18a4 4 0 0 1 4-4z"}),s.createElement("path",{className:ne.arrow,d:"M5.5 10l-2 3.5 2 3.5"})))}var a,l,s,c,u,d,p,h,m,f,v,g,b,T,y,_,C,w,S,k,L,A,E,D,N,B,W,F,V,P,I,O,z,M,R,x,G,U,H,j,J,q,K,Q,Z,Y,X,$,ee,te,oe,ne,ie,re,ae,le,se,ce;Object.defineProperty(t,"__esModule",{value:!0}),a=o(0),o(9),l=o(56),s=o(4),c=o(30),u=o(12),d=o(44),p=o(5),h=o(41),m=o(32),f=o(58),v=o(333),g=function(){function e(e){this._drawingsAccess=e||{tools:[],type:"black"}}return e.prototype.isToolEnabled=function(e){var t=this._findTool(e);return!(!t||!t.grayed)||("black"===this._drawingsAccess.type?!t:!!t)},e.prototype.isToolGrayed=function(e){var t=this._findTool(e);return!(!t||!t.grayed)},e.prototype._findTool=function(e){return this._drawingsAccess.tools.find(function(t){return t.name===e})},e}(),b=[[{name:"cursor"},{name:"dot"},{name:"arrow"},{name:"eraser"}],[{name:"LineToolTrendLine"},{name:"LineToolTrendAngle"},{name:"LineToolHorzLine",shortcut:{keys:"Alt+H",immediately:!0}},{name:"LineToolHorzRay"},{name:"LineToolVertLine",shortcut:{keys:"Alt+V",immediately:!0}},{name:"LineToolCrossLine",shortcut:{keys:"Alt+C",immediately:!0}},{name:"LineToolArrow"},{name:"LineToolRay"},{name:"LineToolExtended"},{name:"LineToolParallelChannel"},{name:"LineToolDisjointAngle"},{name:"LineToolFlatBottom"}],[{name:"LineToolPitchfork"},{name:"LineToolSchiffPitchfork2"},{name:"LineToolSchiffPitchfork"},{name:"LineToolInsidePitchfork"},{name:"LineToolPitchfan"},{name:"LineToolGannSquare"},{name:"LineToolGannComplex"},{name:"LineToolGannFixed"},{name:"LineToolGannFan"},{name:"LineToolFibRetracement"},{name:"LineToolTrendBasedFibExtension"},{name:"LineToolFibSpeedResistanceFan"},{name:"LineToolFibTimeZone"},{name:"LineToolTrendBasedFibTime"},{name:"LineToolFibCircles"},{name:"LineToolFibSpiral"},{
name:"LineToolFibSpeedResistanceArcs"},{name:"LineToolFibWedge"},{name:"LineToolFibChannel"}],[{name:"LineToolBrush"},{name:"LineToolRectangle"},{name:"LineToolRotatedRectangle"},{name:"LineToolEllipse"},{name:"LineToolTriangle"},{name:"LineToolPolyline"},{name:"LineToolBezierQuadro"},{name:"LineToolBezierCubic"},{name:"LineToolArc"}],[{name:"LineToolText"},{name:"LineToolTextAbsolute"},{name:"LineToolNote"},{name:"LineToolNoteAbsolute"},{name:"LineToolCallout"},{name:"LineToolBalloon"},{name:"LineToolPriceLabel"},{name:"LineToolArrowMarkLeft"},{name:"LineToolArrowMarkRight"},{name:"LineToolArrowMarkUp"},{name:"LineToolArrowMarkDown"},{name:"LineToolFlagMark"}],[{name:"LineTool5PointsPattern"},{name:"LineToolCypherPattern"},{name:"LineToolABCD"},{name:"LineToolTrianglePattern"},{name:"LineToolThreeDrivers"},{name:"LineToolHeadAndShoulders"},{name:"LineToolElliottImpulse"},{name:"LineToolElliottTriangle"},{name:"LineToolElliottTripleCombo"},{name:"LineToolElliottCorrection"},{name:"LineToolElliottDoubleCombo"},{name:"LineToolCircleLines"},{name:"LineToolTimeCycles"},{name:"LineToolSineLine"}],[{name:"LineToolRiskRewardLong"},{name:"LineToolRiskRewardShort"},{name:"LineToolPrediction"},{name:"LineToolDateRange"},{name:"LineToolPriceRange"},{name:"LineToolDateAndPriceRange"},{name:"LineToolBarsPattern"},{name:"LineToolGhostFeed"},{name:"LineToolProjection"}]],T=o(223),y=o(95),_=o(70),C=o(146),w=o(1091),S=o(91),k=o(359),L=function(e){function t(t){var o=e.call(this,t)||this;return o._scroll=null,o._handleScrollTop=function(){o.animateTo(Math.max(0,o.currentPosition()-(o.state.heightWrap-50)))},o._handleScrollBot=function(){o.animateTo(Math.min((o.state.heightContent||0)-(o.state.heightWrap||0),o.currentPosition()+(o.state.heightWrap-50)))},o._handleResizeWrap=function(e){var t=e.height;o.setState({heightWrap:t})},o._handleResizeContent=function(e){var t=e.height;o.setState({heightContent:t})},o._handleScroll=function(){var e=o.props.onScroll;e&&e(o.currentPosition(),o.isAtTop(),o.isAtBot()),o._checkButtonsVisibility()},o._checkButtonsVisibility=function(){var e,t,n,i,r;(o.props.isVisibleButtons||o.props.isVisibleFade)&&(e=o.state,t=e.isVisibleTopButton,n=e.isVisibleBotButton,i=o.isAtTop(),r=o.isAtBot(),i||t?i&&t&&o.setState({isVisibleTopButton:!1}):o.setState({isVisibleTopButton:!0}),r||n?r&&n&&o.setState({isVisibleBotButton:!1}):o.setState({isVisibleBotButton:!0}))},o.state={heightContent:0,heightWrap:0,isVisibleBotButton:!1,isVisibleTopButton:!1},o}return a.c(t,e),t.prototype.componentDidMount=function(){this._checkButtonsVisibility()},t.prototype.componentDidUpdate=function(e,t){t.heightWrap===this.state.heightWrap&&t.heightContent===this.state.heightContent||this._handleScroll()},t.prototype.currentPosition=function(){return this._scroll?this._scroll.scrollTop:0},t.prototype.isAtTop=function(){return this.currentPosition()<=1},t.prototype.isAtBot=function(){return this.currentPosition()+this.state.heightWrap>=this.state.heightContent-1},t.prototype.animateTo=function(e,t){if(void 0===t&&(t=S.dur),this._scroll){
var o=c.findDOMNode(this._scroll);Object(C.doAnimate)({onStep:function(e,t){o.scrollTop=t},from:o.scrollTop,to:Math.round(e),easing:S.easingFunc.easeInOutCubic,duration:t})}},t.prototype.render=function(){var e,t,o,n,i,r=this,a=this.props,l=a.children,c=a.isVisibleScrollbar,d=a.isVisibleFade,p=a.isVisibleButtons,h=this.state,m=h.heightContent,f=h.heightWrap,v=h.isVisibleBotButton,g=h.isVisibleTopButton;return s.createElement(y,{whitelist:["height"],onMeasure:this._handleResizeWrap},s.createElement("div",{className:w.wrap},s.createElement("div",{className:u(w.scrollWrap,(e={},e[w.noScrollBar]=!c,e)),onScroll:this._handleScroll,ref:function(e){return r._scroll=e}},s.createElement(y,{onMeasure:this._handleResizeContent,whitelist:["height"]},s.createElement("div",{className:w.content},l))),d&&s.createElement("div",{className:u(w.fadeTop,(t={},t[w.isVisible]=g&&m>f,t))}),d&&s.createElement("div",{className:u(w.fadeBot,(o={},o[w.isVisible]=v&&m>f,o))}),p&&s.createElement("div",{className:u(w.scrollTop,(n={},n[w.isVisible]=g&&m>f,n)),onClick:this._handleScrollTop},s.createElement("div",{className:w.iconWrap},s.createElement(_.a,{icon:k,className:w.icon}))),p&&s.createElement("div",{className:u(w.scrollBot,(i={},i[w.isVisible]=v&&m>f,i)),onClick:this._handleScrollBot},s.createElement("div",{className:w.iconWrap},s.createElement(_.a,{icon:k,className:w.icon})))))},t.defaultProps={isVisibleScrollbar:!0},t}(s.PureComponent),A=o(340),E=o(221),D=o(142),N=o(1092),B=o(145),W=o(361),F=o(147),V=o(1093),P=o(1047),I=function(e){function t(t){var o=e.call(this,t)||this;return o._toggleDropdown=function(e){o.setState({isOpened:void 0!==e?e:!o.state.isOpened})},o._handleClose=function(){o._toggleDropdown(!1)},o._getDropdownPosition=function(){if(!o._control)return{x:0,y:0};var e=o._control.getBoundingClientRect();return{x:e.left+e.width+1,y:e.top-6}},o._handleClickArrow=function(){o._toggleDropdown()},o._handleTouchStart=function(){o.props.onClickButton(),o._toggleDropdown()},o._handlePressStart=function(){if(Modernizr.touch)o._longPressDelay||o.props.onClickButton();else{if(o._doubleClickDelay)return clearTimeout(o._doubleClickDelay),delete o._doubleClickDelay,void o._toggleDropdown(!0);o._doubleClickDelay=setTimeout(function(){delete o._doubleClickDelay,o._longPressDelay||o.props.onClickButton()},175)}o._longPressDelay=setTimeout(function(){delete o._longPressDelay,o._toggleDropdown(!0)},300)},o._handlePressEnd=function(){o._longPressDelay&&(clearTimeout(o._longPressDelay),delete o._longPressDelay,o.state.isOpened?o._toggleDropdown(!1):o.state.isOpened||!o.props.isActive||Modernizr.touch||o._toggleDropdown(!0))},o.state={isOpened:!1},o}return a.c(t,e),t.prototype.render=function(){var e,t=this,o=this.props,i=o.buttonActiveClass,r=o.buttonClass,a=o.buttonIcon,l=o.buttonTitle,c=o.buttonHotKey,d=o.children,p=o.isActive,h=o.isGrayed,m=o.onClickWhenGrayed,f=this.state.isOpened;return s.createElement("div",{className:u(V.dropdown,(e={},e["apply-common-tooltip common-tooltip-vertical"]=!!l,e[V.isGrayed]=h,e[V.isActive]=p,e[V.isOpened]=f,e)),
onClick:h?m:void 0,title:l,"data-tooltip-hotkey":c,"data-tooltip-delay":1500},s.createElement("div",{ref:function(e){return t._control=e},className:V.control},s.createElement("div",{className:V.buttonWrap,onMouseDown:h||Modernizr.touch?void 0:this._handlePressStart,onMouseUp:h||Modernizr.touch?void 0:this._handlePressEnd,onClick:!h&&Modernizr.touch?this._handleTouchStart:void 0},s.createElement(n,{activeClass:i,className:r,icon:a,isActive:p,isGrayed:h,isTransparent:!0})),!h&&!Modernizr.touch&&s.createElement("div",{className:V.arrow,onClick:this._handleClickArrow},s.createElement(_.a,{className:V.arrowIcon,icon:P}))),!h&&s.createElement(F.a,{doNotCloseOn:this,isOpened:f,onClose:this._handleClose,position:this._getDropdownPosition},d))},t}(s.PureComponent),O=o(96),z=o(1094),M={icon:window.t("Icon")},R=10,x=function(e){function t(t){var o=e.call(this,t)||this;return o._renderItem=function(e){return s.createElement("div",{className:z.item,key:e,onClick:function(){o._handleSelect(e),Object(D.b)()}},String.fromCharCode(e))},o._onChangeDrawingState=function(){o.setState({isActive:o._isActive()})},o._handleSelect=function(e){var t,n;Object(B.saveDefaults)("linetoolicon",a.a({},Object(B.defaults)("linetoolicon"),{icon:e})),h.tool.setValue("LineToolIcon"),t=o.state.recents,n=t.indexOf(e),-1!==n&&t.splice(n,1),t=[e].concat(t.slice(0,R-1)),Object(d.setJSON)("linetoolicon.recenticons",t),o.setState({current:e,recents:t})},o.state={current:Object(B.defaults)("linetoolicon").icon,recents:Object(d.getJSON)("linetoolicon.recenticons")||[]},o}return a.c(t,e),t.prototype.componentDidMount=function(){h.tool.subscribe(this._onChangeDrawingState),d.onSync.subscribe(this,this._onSyncSettings)},t.prototype.componentWillUnmount=function(){h.tool.unsubscribe(this._onChangeDrawingState),d.onSync.unsubscribe(this,this._onSyncSettings)},t.prototype.render=function(){var e=this,t=this.props,o=t.isGrayed,n=t.toolName,i=this.state,r=i.current,a=i.isActive,l=i.recents;return s.createElement(I,{buttonClass:z.button,buttonIcon:s.createElement("div",{className:z.buttonIcon},String.fromCharCode(r||W.availableIcons[0])),buttonTitle:M.icon,isActive:a,isGrayed:o,onClickButton:function(){return e._handleSelect(r||W.availableIcons[0])},onClickWhenGrayed:function(){return Object(m.emit)("onGrayedObjectClicked",{type:"drawing",name:v.lineToolsInfo[n].localizedName})}},l&&[s.createElement("div",{key:"recent",className:z.wrap},l.map(this._renderItem)),s.createElement(O.a,{key:"separator"})],s.createElement("div",{key:"all",className:z.wrap},W.availableIcons.map(this._renderItem)))},t.prototype._isActive=function(){return h.tool.value()===this.props.toolName},t.prototype._onSyncSettings=function(){this.setState({recents:Object(d.getJSON)("linetoolicon.recenticons")})},t}(s.Component),G=o(3),U=function(e){function t(t){var o=e.call(this,t)||this;return o._handleClick=function(){o.props.saveDefaultOnChange&&Object(G.saveDefaultProperties)(!0),o.props.property.setValue(!o.props.property.value()),o.props.saveDefaultOnChange&&Object(G.saveDefaultProperties)(!1)},
o.state={isActive:o.props.property.value()},o}return a.c(t,e),t.prototype.componentDidMount=function(){this.props.property.subscribe(this,this._onChange)},t.prototype.componentWillUnmount=function(){this.props.property.unsubscribe(this,this._onChange)},t.prototype.render=function(){var e=this.props.toolName,t=this.state.isActive,o=v.lineToolsInfo[e];return s.createElement(n,{icon:t&&o.iconActive?o.iconActive:o.icon,isActive:t,onClick:this._handleClick,title:o.localizedName})},t.prototype._onChange=function(e){this.setState({isActive:e.value()})},t}(s.PureComponent),H=function(e){function t(t){var o=e.call(this,t)||this;return o._handleClick=function(){h.tool.setValue(o.props.toolName)},o._onChange=function(){o.setState({isActive:h.tool.value()===o.props.toolName})},o.state={isActive:h.tool.value()===o.props.toolName},o}return a.c(t,e),t.prototype.componentDidMount=function(){h.tool.subscribe(this._onChange)},t.prototype.componentWillUnmount=function(){h.tool.unsubscribe(this._onChange)},t.prototype.render=function(){var e=this.props.toolName,t=this.state.isActive,o=v.lineToolsInfo[e];return s.createElement(n,{icon:v.lineToolsInfo[e].icon,isActive:t,isTransparent:!0,onClick:this._handleClick,title:o.localizedName,buttonHotKey:o.hotKey})},t}(s.PureComponent),j=o(328),J=o(1095),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props.enterAnimationClass,t=void 0===e?J.enter:e,o=this.props.enterActiveAnimationClass,n=void 0===o?J.enterActive:o,i=this.props.enterLeaveAnimationClass,r=void 0===i?J.leave:i,a=this.props.itemClassName,l=void 0===a?J.item:a;return s.createElement(j.CSSTransitionGroup,{transitionName:{enter:t,enterActive:n,leave:r},transitionEnter:!0,transitionEnterTimeout:S.dur/2,transitionLeave:!0,transitionLeaveTimeout:.75*S.dur},this.props.isVisible&&s.createElement("div",{key:"button",className:l},this.props.children))},t}(s.PureComponent),K=function(e){function t(t){var o=e.call(this,t)||this;return o._boundUndoModel=null,o._handleClick=function(){var e=o._activeChartWidget().model();e&&e.zoomFromViewport()},o._syncUnzoomButton=function(){var e=o._activeChartWidget(),t=e.model(),n=!1;t?(o._boundUndoModel!==t&&(o._boundUndoModel&&o._boundUndoModel.zoomStack().onChange().unsubscribe(null,o._syncUnzoomButton),t.zoomStack().onChange().subscribe(null,o._syncUnzoomButton),o._boundUndoModel=t),n=!t.zoomStack().isEmpty()):e.withModel(null,o._syncUnzoomButton),o.setState({isVisible:n})},o.state={isVisible:!1},o}return a.c(t,e),t.prototype.componentDidMount=function(){this.props.chartWidgetCollection.activeChartWidget.subscribe(this._syncUnzoomButton,{callWithLast:!0})},t.prototype.componentWillUnmount=function(){this.props.chartWidgetCollection.activeChartWidget.unsubscribe(this._syncUnzoomButton)},t.prototype.render=function(){return s.createElement(q,{isVisible:this.state.isVisible},s.createElement(i,{action:this._handleClick,isTransparent:!0,toolName:"zoom-out"}))},t.prototype._activeChartWidget=function(){
return this.props.chartWidgetCollection.activeChartWidget.value()},t}(s.PureComponent),Q=o(1048),Z=o(148),Y=o(80),X=o(207),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.componentDidMount=function(){X.bind(this.props.keys,this.props.handler)},t.prototype.componentDidUpdate=function(e){this.props.keys===e.keys&&this.props.handler===e.handler||(X.unbind(e.keys),X.bind(this.props.keys,this.props.handler))},t.prototype.componentWillUnmount=function(){X.unbind(this.props.keys)},t.prototype.render=function(){return null},t}(s.PureComponent),ee=function(e){function t(t){var o,n=e.call(this,t)||this;return n._onChangeDrawingState=function(){var e=n._getActiveToolIndex();n.setState({current:-1!==e?e:n.state.current,isActive:-1!==e})},n._handleClickButton=function(){var e=n._getCurrentToolName();n._selectTool(e)},n._handleClickItem=function(e){n._selectTool(e)},n._handleGrayedClick=function(e){Object(m.emit)("onGrayedObjectClicked",{type:"drawing",name:v.lineToolsInfo[e].localizedName})},n._handleShortcut=function(e){var t=n.props.lineTools.find(function(t){return t.name===e}),o=t&&t.shortcut;o&&o.immediately?n._drawLinetoolImmediately(e):n._selectTool(e)},n._drawLinetoolImmediately=function(e){var t=n.props.chartWidgetCollection.activeChartWidget.value();t.activePaneWidget&&t.activePaneWidget.drawRightThere(e)},n._handleClickFavorite=function(e){n.state.favState&&n.state.favState[e]?Q.a.removeFavorite(e):Q.a.addFavorite(e)},n._onAddFavorite=function(e){var t;n.setState({favState:a.a({},n.state.favState,(t={},t[e]=!0,t))})},n._onRemoveFavorite=function(e){var t;n.setState({favState:a.a({},n.state.favState,(t={},t[e]=!1,t))})},n._onSyncFavorites=function(){n.setState({favState:n._composeFavState()})},o=n._getActiveToolIndex(),n.state={current:-1===o?n._firstNonGrayedTool():o,favState:n._composeFavState(),isActive:-1!==o},n}return a.c(t,e),t.prototype.componentDidMount=function(){h.tool.subscribe(this._onChangeDrawingState),Q.a.favoriteAdded.subscribe(null,this._onAddFavorite),Q.a.favoriteRemoved.subscribe(null,this._onRemoveFavorite),Q.a.favoritesSynced.subscribe(null,this._onSyncFavorites)},t.prototype.componentWillUnmount=function(){h.tool.unsubscribe(this._onChangeDrawingState),Q.a.favoriteAdded.unsubscribe(null,this._onAddFavorite),Q.a.favoriteRemoved.unsubscribe(null,this._onRemoveFavorite),Q.a.favoritesSynced.unsubscribe(null,this._onSyncFavorites)},t.prototype.componentDidUpdate=function(e,t){e.lineTools!==this.props.lineTools&&this.setState({favState:this._composeFavState()})},t.prototype.render=function(){var e=this,t=this.props,o=t.favoriting,n=t.grayedTools,i=t.lineTools,r=this.state,a=r.current,l=r.favState,c=r.isActive,u=this._getCurrentToolName(),d=v.lineToolsInfo[u],p=this._showHint();return s.createElement("span",null,s.createElement(I,{buttonIcon:d.icon,buttonTitle:d.localizedName,buttonHotKey:d.hotKey,isActive:c,onClickButton:this._handleClickButton},i.map(function(t,i){var r=t.name,u=v.lineToolsInfo[r],d=n[r];return s.createElement(Y.a,{key:r,
dontClosePopup:d,forceShowHint:p,hint:t.shortcut&&t.shortcut.keys,icon:u.icon,isActive:c&&a===i,appearAsDisabled:d,label:u.localizedName,onClick:d?e._handleGrayedClick:e._handleClickItem,onClickArg:r,showToolboxOnHover:!l[r],toolbox:o&&!d?s.createElement(Z.a,{isFilled:l[r],onClick:e._handleClickFavorite,onClickArg:r}):void 0})})),i.map(function(t,o){var n=t.name,i=t.shortcut;return i&&s.createElement($,{handler:function(t){t.preventDefault(),e._handleShortcut(n)},key:n,keys:i.keys})}))},t.prototype._getCurrentToolName=function(){var e=this.state.current;return this.props.lineTools[e||0].name},t.prototype._firstNonGrayedTool=function(){var e=this.props,t=e.grayedTools;return e.lineTools.findIndex(function(e){return!t[e.name]})},t.prototype._getActiveToolIndex=function(){return this.props.lineTools.findIndex(function(e){return e.name===h.tool.value()})},t.prototype._showHint=function(){return this.props.lineTools.some(function(e){return"shortcut"in e})},t.prototype._selectTool=function(e){h.tool.setValue(e)},t.prototype._composeFavState=function(){var e={};return this.props.lineTools.forEach(function(t){e[t.name]=Q.a.isFavorite(t.name)}),e},t}(s.PureComponent),te={all:window.t("Remove Drawing Tools & Indicators"),drawings:window.t("Remove Drawing Tools"),studies:window.t("Remove Indicators")},oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleRemoveDrawings=function(){t.props.chartWidgetCollection.activeChartWidget.value().removeAllDrawingTools()},t._handleRemoveStudies=function(){t.props.chartWidgetCollection.activeChartWidget.value().removeAllStudies()},t._handleRemoveAll=function(){t.props.chartWidgetCollection.activeChartWidget.value().removeAllStudiesDrawingTools()},t}return a.c(t,e),t.prototype.render=function(){return s.createElement(I,{buttonIcon:v.lineToolsInfo[this.props.toolName].icon,buttonTitle:te.drawings,onClickButton:this._handleRemoveDrawings},s.createElement(Y.a,{label:te.drawings,onClick:this._handleRemoveDrawings}),s.createElement(Y.a,{label:te.studies,onClick:this._handleRemoveStudies}),s.createElement(Y.a,{label:te.all,onClick:this._handleRemoveAll}))},t}(s.PureComponent),ne=o(1096),ie="http://www.w3.org/2000/svg",re=o(360),ae=o(1097),o.d(t,"DrawingToolbar",function(){return ce}),le={hide:window.t("Hide Drawings Toolbar"),show:window.t("Show Drawings Toolbar")},se=Object(f.onWidget)(),ce=function(e){function t(t){var o=e.call(this,t)||this;return o._grayedTools={},o._handleChangeVisibility=function(e){o.setState({isVisible:e})},o._toggleVisibility=function(){T.isDrawingToolbarVisible.setValue(!T.isDrawingToolbarVisible.value())},o._handleEsc=function(){h.resetToCursor(!0),Object(D.b)()},h.init(),o._toolsFilter=new g(o.props.drawingsAccess),o._filteredLineTools=b.map(function(e){return e.filter(function(e){return o._toolsFilter.isToolEnabled(v.lineToolsInfo[e.name].localizedName)})}).filter(function(e){return 0!==e.length}),o._filteredLineTools.forEach(function(e){return e.forEach(function(e){
o._grayedTools[e.name]=o._toolsFilter.isToolGrayed(v.lineToolsInfo[e.name].localizedName)})}),o.state={isVisible:T.isDrawingToolbarVisible.value()},o._features={favoriting:!se&&p.enabled("items_favoriting"),multicharts:p.enabled("support_multicharts"),tools:!se||p.enabled("charting_library_base")},o._negotiateResizer(),o}return a.c(t,e),t.prototype.componentDidMount=function(){T.isDrawingToolbarVisible.subscribe(this._handleChangeVisibility),c.findDOMNode(this).addEventListener("contextmenu",function(e){return e.preventDefault()})},t.prototype.componentWillUnmount=function(){T.isDrawingToolbarVisible.unsubscribe(this._handleChangeVisibility)},t.prototype.componentDidUpdate=function(e,t){var o=this.state.isVisible;o!==t.isVisible&&(m.emit("toggle_sidebar",!o),d.setValue("ChartDrawingToolbarWidget.visible",o),this._negotiateResizer())},t.prototype.render=function(){var e,t=this,o=this.props,n=o.bgColor,a=o.chartWidgetCollection,l=o.readOnly,c=this.state.isVisible,d={backgroundColor:n&&"#"+n};return s.createElement("div",{className:u(ae.drawingToolbar,(e={},e[ae.isHidden]=!c,e)),style:d},s.createElement(L,{onScroll:D.b,isVisibleFade:Modernizr.touch,isVisibleButtons:!Modernizr.touch,isVisibleScrollbar:!1},s.createElement("div",{className:ae.inner},!l&&s.createElement("div",{className:ae.group,style:d},this._filteredLineTools.map(function(e,o){return s.createElement(ee,{chartWidgetCollection:a,favoriting:t._features.favoriting,grayedTools:t._grayedTools,key:o,lineTools:e})}),this._toolsFilter.isToolEnabled("Font Icons")&&s.createElement(x,{isGrayed:this._grayedTools["Font Icons"],toolName:"LineToolIcon"})),!l&&s.createElement("div",{className:ae.group,style:d},s.createElement(H,{toolName:"measure"}),s.createElement(H,{toolName:"zoom"}),s.createElement(K,{chartWidgetCollection:a})),!l&&s.createElement("div",{className:ae.group,style:d},s.createElement(U,{property:h.properties().magnet,saveDefaultOnChange:!0,toolName:"magnet"}),this._features.tools&&s.createElement(U,{property:h.properties().stayInDrawingMode,saveDefaultOnChange:!0,toolName:"drawginmode"}),this._features.tools&&s.createElement(U,{property:h.lockDrawings(),toolName:"lockAllDrawings"}),this._features.tools&&s.createElement(U,{property:h.hideAllDrawings(),toolName:"hideAllDrawings"})),!l&&this._features.tools&&s.createElement("div",{className:ae.group,style:d},s.createElement(i,{action:function(){return t._activeChartWidget().showObjectsTreeDialog()},toolName:"showObjectsTree"}),s.createElement(oe,{chartWidgetCollection:a,toolName:"removeAllDrawingTools"})))),s.createElement("div",{className:u(ae.toggleButton,"apply-common-tooltip common-tooltip-vertical",!c&&ae.collapsed),onClick:this._toggleVisibility,title:c?le.hide:le.show},s.createElement(r,{direction:c?"left":"right"})),s.createElement(A.a,{keyCode:E.a.Escape,handler:this._handleEsc}))},t.prototype._activeChartWidget=function(){return this.props.chartWidgetCollection.activeChartWidget.value()},t.prototype._negotiateResizer=function(){this.props.resizerBridge.negotiateWidth(this.state.isVisible?re.b:re.a)
},t}(s.PureComponent)}});